"use strict";requirejs(["jquery","axios","Vimeo","easyTimer","jqueryTimer"],function(n,e,o,t){function i(){var n={loop:!1};_=new o("videoplayer",n),_.setVolume(.5),_.ready().then(function(){console.info("Player is ready."),_.getDuration().then(function(n){b=n,r()}).catch(function(n){console.error(n)}),q<b-5&&window.confirm("마지막 재생시점으로 이동하시겠습니까?")&&_.setCurrentTime(q).then(function(n){_.pause()}).catch(function(n){console.error(n)})}).catch(function(n){console.error(n)})}function r(){b?(y=n.timer(1e3*g,c,!0),y.stop(),s()):console.error("재생시간을 확인할 수 없습니다.")}function s(){a(O)}function a(n){Math.floor(b*(T/100))<=n&&(x.removeClass("blind"),P.addClass("blind"))}function c(){w+=g,_.getCurrentTime().then(function(e){return m>0&&m===e?void _.pause().then(function(){console.log("비디오가 중지되었습니다."),P.removeClass("blind")}).catch(function(n){console.error(n)}):(m=e,void n.ajax({type:"POST",url:"/video/log/playtime",data:{training_user_id:D,video_id:V,played_seconds:w,video_duration:b,currenttime:e}}).done(function(n){n.success?(w=0,O=n.total_played_seconds,a(O)):(console.error(n.msg),_.pause().then(function(){}).catch(function(n){console.error(n)}))}))}).catch(function(n){console.error(n)})}function u(){n.ajax({type:"POST",url:"/video/log/endtime",data:{video_id:V}}).done(function(n){n.success||console.error(n.msg)})}function d(){n.ajax({type:"POST",url:"/session/log/starttime",data:{training_user_id:D,course_id:E,course_list_id:k}}).done(function(n){n.success?C=n.hasEnded:(console.error(n.msg),y.stop(),_.stop())})}function l(){n.ajax({type:"POST",url:"/session/log/endtime",data:{training_user_id:D,course_id:E,course_list_id:k}}).done(function(n){n.success?window.location.href=S:(console.error(n.msg),y.stop(),_.stop())})}function f(){return e.delete("/video/log",{params:{video_id:V}}).then(function(n){}).catch(function(n){console.error(n)})}function p(){return e.delete("/session/log",{params:{training_user_id:D,course_list_id:k}}).then(function(n){}).catch(function(n){console.error(n)})}var m,h,_=null,v=n(".videoplayer"),g=v.data("interval"),y=null,w=0,T=(v.data("wait-seconds"),v.data("passive-rate")),b=null,j=n("#countdown .values"),C=!1,x=n("#btn_play_next"),S=x.parent().attr("href"),P=n("#btn_replay_video"),V=v.data("id"),O=v.data("total-play"),q=v.data("current-time"),D=x.data("training-user-id"),E=x.data("course-id"),k=x.data("course-list-id");n(function(){i()}),x.on("click",function(n){n.preventDefault(),l()}),_.on("play",function(n){d(),y.reset(1e3*g)}),_.on("error",function(n){console.info("error!"),console.error(n)}),_.on("pause",function(n){console.info("player: pause"),y.pause(),u()}),_.on("ended",function(o){console.info("player: ended"),y.pause(),a(O+g),u(),C||setTimeout(function(){n(".timer").removeClass("blind"),h=new t,h.start({countdown:!0,startValues:{seconds:30}}),j.html(h.getTimeValues().toString()+" 초 이내 <b>다음</b> 버튼을 클릭해주세요."),h.addEventListener("secondsUpdated",function(n){j.html(h.getTimeValues().toString()+" 초 이내 <b>다음</b> 버튼을 클릭해주세요.")}),h.addEventListener("targetAchieved",function(n){j.html("학습 초기화 중입니다.."),setTimeout(function(){window.alert("30초 동안 다음 버튼을 누르지 않아 학습을 초기화 하였습니다.\n\n재시청 해주시기 바랍니다."),e.all([f(),p()]).then(e.spread(function(n,e){window.location.reload()}))},3e3)})},1e3)}),P.on("click",function(n){n.preventDefault(),_.unload().then(function(){P.addClass("blind")}).catch(function(n){console.log(n)})})});
//# sourceMappingURL=../maps/video.js.map
